# 串口控制视频播放器 - 直接信号映射版

一个基于串口通信的视频播放工具，可以根据接收到的串口信号直接映射播放对应的视频文件。支持全屏播放，适用于无线发射器控制的应用场景。

## 功能特性

- **串口通信**: 支持标准串口通信，默认配置 9600-8-N-1
- **直接信号映射**: 使用接收到的完整数据直接进行视频映射，无需提取标识符
- **视频映射**: 支持信号与视频文件的自定义映射关系
- **全屏播放**: 自动全屏播放视频，支持多种视频格式
- **批量导入**: 支持批量导入视频文件夹，自动生成数字信号映射
- **实时日志**: 显示串口接收数据和播放状态的实时日志
- **用户界面**: 提供友好的图形用户界面，便于配置和管理

## 系统要求

- Windows 10/11
- Visual Studio 2019/2022 或 Visual Studio Build Tools（编译时需要）
- DirectShow 支持（系统自带）

## 安装和使用

### 快速开始

1. **编译程序**:
   ```cmd
   compile.bat
   ```

2. **运行程序**:
   ```cmd
   run.bat
   ```

### 手动编译

如果需要手动编译，请确保安装了 Visual Studio 2019/2022 或 Build Tools，然后运行：

```cmd
cl /EHsc /MT SerialVideoPlayer.cpp /Fe:SerialVideoPlayer.exe /link user32.lib gdi32.lib comctl32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib strmiids.lib
```

## 软件配置

### 1. 串口设置
- **串口选择**: 从下拉列表中选择可用的COM端口
- **波特率**: 9600（默认），也可选择其他标准波特率
- **数据位**: 8
- **校验位**: 无
- **停止位**: 1

### 2. 视频映射设置

#### 手动添加映射
1. 在"信号数据"框中输入完整的信号数据（如：25、A1 25 A1、Button1等）
2. 选择对应的视频文件
3. 点击"添加映射"按钮

#### 批量导入
1. 点击"批量导入视频文件夹"按钮
2. 选择包含视频文件的文件夹
3. 系统会自动为每个视频文件分配数字信号（1、2、3...）

## 信号格式

**重要更新**: 本版本使用直接信号映射，不再提取标识符！

程序会将接收到的完整串口数据作为信号进行映射：

```
接收数据: "25" → 播放信号 "25" 对应的视频
接收数据: "A1 25 A1" → 播放信号 "A1 25 A1" 对应的视频
接收数据: "Button1" → 播放信号 "Button1" 对应的视频
```

- 支持任意格式的信号数据
- 信号数据区分大小写
- 建议使用简短明确的信号标识

## 视频播放控制

- **自动全屏**: 视频会自动以全屏模式播放
- **退出播放**: 
  - 按 ESC 键
  - 按 Enter 键
  - 按空格键
  - 点击鼠标任意键
  - 视频播放完成后自动退出

## 技术实现

- **UI框架**: Windows API (Win32)
- **串口通信**: Windows API (CreateFile, ReadFile)
- **视频播放**: DirectShow
- **多线程**: std::thread 进行串口数据读取
- **信号处理**: 直接字符串匹配，无需解析

## 支持的视频格式

- MP4 (推荐)
- AVI
- MKV
- WMV
- MOV
- FLV
- WebM

## 配置示例

### 示例1: 数字信号
假设您有以下视频文件和对应的数字信号：
- 信号 "1" → intro.mp4
- 信号 "2" → demo1.mp4
- 信号 "3" → demo2.mp4

当串口接收到 "1" 时，播放 intro.mp4

### 示例2: 复杂信号
如果您的发射器发送复杂格式：
- 信号 "A1 25 A1" → video1.mp4
- 信号 "B2 30 B2" → video2.mp4

程序会完全匹配接收到的数据进行播放

### 示例3: 批量导入
选择包含视频的文件夹后，系统自动生成：
- 信号 "1" → 第一个视频文件
- 信号 "2" → 第二个视频文件
- 信号 "3" → 第三个视频文件
- ...

## 故障排除

### 常见问题

1. **串口连接失败**
   - 检查串口是否被其他程序占用
   - 确认串口号是否正确
   - 检查串口设备是否正常连接

2. **视频无法播放**
   - 确认视频文件路径正确
   - 检查视频格式是否支持
   - 确认系统已安装必要的解码器

3. **信号无法识别**
   - 检查信号映射是否正确配置
   - 确认接收到的数据与映射的信号完全一致
   - 查看接收日志确认实际接收的数据内容
   - 注意信号数据的大小写敏感性

4. **编译失败**
   - 确认已安装 Visual Studio 或 Build Tools
   - 检查是否缺少必要的库文件
   - 确认 DirectShow 组件可用

## 优化特性

- **简化信号处理**: 移除复杂的信号解析逻辑，直接使用原始数据
- **更高兼容性**: 支持任意格式的信号数据
- **更快响应**: 减少信号处理时间，提高响应速度
- **更易配置**: 信号映射更加直观和灵活

## 开发信息

- **开发语言**: C++ (Win32 + DirectShow)
- **开发环境**: Visual Studio 2022
- **目标平台**: Windows x64
- **版本**: 直接信号映射优化版
- **许可证**: MIT License